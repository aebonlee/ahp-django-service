# AHP 플랫폼 TODO 리스트
**작성일**: 2025-09-26  
**버전**: 4차 개발

---

## 🎯 완료된 작업 (2025-09-26)

### ✅ 백엔드 - 회원 관리 시스템 구축
- [x] Custom User 모델 생성 (`accounts.User`)
  - 4가지 역할: `super_admin`, `service_admin`, `service_user`, `evaluator`
  - 프로필 이미지, 조직 정보, 권한 설정 필드 추가
- [x] UserProfile 모델 (알림 설정, 언어, 시간대 등)
- [x] UserActivityLog 모델 (사용자 활동 추적)
- [x] JWT 인증 시스템
  - Access Token: 1시간 유효
  - Refresh Token: 7일 유효
  - 자동 토큰 갱신 기능
- [x] 회원가입/로그인/로그아웃 API
- [x] 역할 기반 권한 시스템 (RBAC)
  - `IsSuperAdmin`, `IsServiceAdmin`, `IsServiceUser`
  - `IsProjectOwner`, `CanCreateProject`
  - `IsEvaluatorOrOwner`

### ✅ 백엔드 - 데이터 모델 통합
- [x] Project 모델 User 참조를 `settings.AUTH_USER_MODEL`로 변경
- [x] Evaluator 모델 User 참조 수정
- [x] 모든 ViewSet에 인증 및 권한 적용
- [x] 사용자 역할별 데이터 필터링

### ✅ 프론트엔드 - 인증 시스템 통합
- [x] TypeScript 타입 정의 (`types/index.ts`)
  - `User`, `UserRole`, `UserProfile`
  - `Project`, `Criteria`, `Alternative`, `Evaluator`
  - `AuthTokens`, `LoginResponse`
- [x] authService 생성
  - JWT 토큰 관리 (localStorage)
  - 자동 토큰 갱신
  - `authenticatedFetch` - 인증된 요청 헬퍼
- [x] App.tsx 인증 통합
  - 토큰 기반 자동 로그인
  - 회원가입/로그인/로그아웃 처리

### ✅ 프론트엔드 - 모드 전환 기능
- [x] `viewMode` 상태 관리 (`service` | `evaluator`)
- [x] Sidebar 메뉴 동적 전환
  - 서비스 모드: 프로젝트 관리, 모델 구축, 결과 분석
  - 평가자 모드: 평가 대시보드, 쌍대비교, 직접입력
- [x] 모드 전환 버튼 추가
  - `service_admin`과 `service_user`만 모드 전환 가능
- [x] Layout/Sidebar 컴포넌트 업데이트

### ✅ 프로젝트 정리
- [x] `conts` 폴더 생성
- [x] 이전 버전 파일들 이동
  - 백업 폴더들 (ahp-platform, ahp-platform_0908, backupdata)
  - 이전 Django 폴더들 (ahp_backend, ahp_build, ahp_django, etc.)
  - 배포 관련 문서들 (RENDER_*.md, POSTGRESQL_*.md)
  - 임시 스크립트 파일들 (*.txt, *.py)

---

## 📋 진행 중인 작업

### 🔄 백엔드 배포 및 테스트
- [ ] Render.com에 업데이트된 백엔드 배포
  - [ ] accounts 앱 마이그레이션 실행
  - [ ] 기존 데이터 마이그레이션 (User 모델 변경)
  - [ ] Pillow 라이브러리 설치 확인
- [ ] JWT 인증 테스트
  - [ ] 회원가입 API 테스트
  - [ ] 로그인 API 테스트
  - [ ] 토큰 갱신 테스트
  - [ ] 권한 기반 접근 제어 테스트

### 🔄 프론트엔드 통합 테스트
- [ ] 회원가입/로그인 UI 테스트
- [ ] 토큰 기반 인증 확인
- [ ] 모드 전환 기능 테스트
- [ ] API 요청 시 토큰 자동 포함 확인
- [ ] 401 에러 시 자동 토큰 갱신 테스트

---

## 📝 향후 개발 계획

### Phase 1: 기본 기능 완성 (1-2주)
- [ ] 프로젝트 CRUD 완전 구현
  - [ ] 프로젝트 생성/수정/삭제
  - [ ] 프로젝트 상태 관리 (setup → results_available)
  - [ ] 프로젝트 공유 및 협업 기능
- [ ] 기준(Criteria) 관리 강화
  - [ ] 계층 구조 편집
  - [ ] 드래그 앤 드롭 재정렬
  - [ ] 가중치 자동 계산
- [ ] 대안(Alternative) 관리
  - [ ] 대안 추가/수정/삭제
  - [ ] 대안 설명 및 메타데이터
- [ ] 평가자(Evaluator) 관리
  - [ ] 평가자 초대 시스템
  - [ ] 이메일 알림 발송
  - [ ] 평가 진행률 추적

### Phase 2: 평가 시스템 (2-3주)
- [ ] 쌍대비교 평가 개선
  - [ ] 일관성 비율(CR) 실시간 계산
  - [ ] 일관성 개선 도우미
  - [ ] 평가 진행률 표시
- [ ] 직접입력 평가
  - [ ] 가중치 직접 입력
  - [ ] 정규화 자동 처리
- [ ] 비교 행렬(Comparison Matrix)
  - [ ] 행렬 시각화
  - [ ] 행렬 일관성 검증
  - [ ] 고유벡터 계산
- [ ] 그룹 의사결정
  - [ ] 개별 평가 통합
  - [ ] 기하평균 계산
  - [ ] 그룹 일관성 분석

### Phase 3: 결과 분석 및 시각화 (2주)
- [ ] 결과 대시보드
  - [ ] 최종 가중치 표시
  - [ ] 대안 순위 표시
  - [ ] 일관성 비율 표시
- [ ] 민감도 분석
  - [ ] 기준 가중치 변화 시뮬레이션
  - [ ] 순위 변동 추적
  - [ ] 민감도 그래프
- [ ] 데이터 시각화
  - [ ] 계층 구조 트리
  - [ ] 가중치 바 차트
  - [ ] 순위 레이더 차트
- [ ] 보고서 생성
  - [ ] PDF 내보내기
  - [ ] Excel 내보내기
  - [ ] 분석 보고서 자동 생성

### Phase 4: 고급 기능 (3-4주)
- [ ] 실시간 협업
  - [ ] WebSocket 연동
  - [ ] 실시간 평가 현황
  - [ ] 채팅 기능
- [ ] 이메일 알림 시스템
  - [ ] 평가자 초대 메일
  - [ ] 평가 완료 알림
  - [ ] 프로젝트 상태 변경 알림
- [ ] 대시보드 개인화
  - [ ] 사용자 설정 저장
  - [ ] 즐겨찾기 프로젝트
  - [ ] 최근 활동 히스토리
- [ ] 데이터 백업 및 복원
  - [ ] 프로젝트 내보내기/가져오기
  - [ ] 자동 백업
  - [ ] 버전 관리

### Phase 5: 시스템 관리 (2주)
- [ ] 슈퍼 관리자 기능
  - [ ] 전체 사용자 관리
  - [ ] 시스템 통계
  - [ ] 감사 로그
- [ ] 모니터링 및 로깅
  - [ ] 에러 추적
  - [ ] 성능 모니터링
  - [ ] 사용량 통계
- [ ] 보안 강화
  - [ ] 2FA (Two-Factor Authentication)
  - [ ] 비밀번호 정책
  - [ ] 세션 관리

---

## 🐛 버그 및 이슈

### 높음 (High Priority)
- [ ] 백엔드 배포 후 마이그레이션 오류 가능성
  - User 모델 변경으로 인한 기존 데이터 마이그레이션 필요
- [ ] 프론트엔드 LoginForm/RegisterForm 컴포넌트 업데이트 필요
  - 현재는 email 기반, 변경 필요: username 기반
- [ ] API 엔드포인트 불일치
  - 프론트엔드: `/api/service/auth/` 
  - 백엔드: `/api/auth/`

### 중간 (Medium Priority)
- [ ] 토큰 만료 시 사용자 경험 개선
  - 현재: 자동 갱신 실패 시 로그아웃
  - 개선: 갱신 실패 시 로그인 페이지로 리다이렉트 + 메시지
- [ ] 모드 전환 시 URL 파라미터 처리
- [ ] 평가자 역할 사용자의 프로젝트 접근 권한 세분화

### 낮음 (Low Priority)
- [ ] 코드 주석 정리
- [ ] 불필요한 console.log 제거
- [ ] TypeScript strict 모드 설정

---

## 📚 문서화 작업
- [ ] API 문서 작성 (Swagger/OpenAPI)
- [ ] 사용자 가이드 작성
- [ ] 관리자 매뉴얼 작성
- [ ] 개발자 가이드 작성
- [ ] 배포 가이드 업데이트

---

## 🔧 기술 부채 (Technical Debt)
- [ ] 프론트엔드 컴포넌트 리팩토링
  - 너무 큰 컴포넌트 분리
  - 중복 코드 제거
- [ ] 백엔드 코드 최적화
  - N+1 쿼리 문제 해결
  - 캐싱 전략 수립
- [ ] 테스트 코드 작성
  - 단위 테스트 (Unit Tests)
  - 통합 테스트 (Integration Tests)
  - E2E 테스트
- [ ] 성능 최적화
  - 프론트엔드 번들 사이즈 최적화
  - 백엔드 API 응답 속도 개선
  - 데이터베이스 인덱싱

---

## 📊 성능 목표
- [ ] 프론트엔드 로딩 시간 < 2초
- [ ] API 응답 시간 < 500ms
- [ ] 동시 사용자 100명 지원
- [ ] 프로젝트당 최대 평가자 50명
- [ ] 계층 구조 최대 5단계

---

## 🎓 학습 및 개선
- [ ] Django REST Framework 고급 기능 학습
- [ ] React 성능 최적화 기법
- [ ] JWT 보안 모범 사례
- [ ] PostgreSQL 쿼리 최적화
- [ ] Docker를 이용한 배포 자동화

---

**마지막 업데이트**: 2025-09-26  
**다음 리뷰 예정일**: 2025-10-03
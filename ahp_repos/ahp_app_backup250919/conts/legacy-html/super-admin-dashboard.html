<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AHP System - ÏäàÌçº Í¥ÄÎ¶¨Ïûê ÎåÄÏãúÎ≥¥Îìú</title>
    <link rel="stylesheet" href="/ahp_app/public/styles/layout.css">
    <style>
        /* Îã§ÌÅ¨ Î™®Îìú Ï∂îÍ∞Ä */
        [data-theme="dark"] {
            --bg-primary: #1f2937;
            --bg-secondary: #111827;
            --bg-subtle: #0f172a;
            --bg-elevated: #374151;
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --text-muted: #9ca3af;
            --border-light: #374151;
            --border-medium: #4b5563;
        }

        .main-content {
            margin-left: var(--sidebar-width);
            margin-top: var(--header-height);
            padding: 2rem;
            background-color: var(--bg-secondary);
            min-height: calc(100vh - var(--header-height));
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .admin-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-light);
            transition: all 0.3s ease;
        }

        .admin-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .admin-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .admin-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .admin-card-icon {
            font-size: 1.5rem;
        }

        .admin-card-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: 0.5rem;
        }

        .admin-card-change {
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .change-positive {
            color: #10b981;
        }

        .change-negative {
            color: #ef4444;
        }

        .management-section {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-light);
            margin-bottom: 2rem;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-light);
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .management-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .management-card {
            background: var(--bg-secondary);
            border-radius: 8px;
            padding: 1.5rem;
            border: 1px solid var(--border-light);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .management-card:hover {
            background: white;
            box-shadow: var(--shadow-sm);
        }

        .management-card-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .management-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .management-card-desc {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .recent-activity {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-light);
        }

        .activity-list {
            list-style: none;
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-light);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .activity-icon.user { background: #dbeafe; color: #2563eb; }
        .activity-icon.project { background: #dcfce7; color: #16a34a; }
        .activity-icon.system { background: #fef3c7; color: #d97706; }
        .activity-icon.alert { background: #fee2e2; color: #dc2626; }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .activity-time {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .theme-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-right: 1rem;
        }

        .theme-toggle {
            width: 2rem;
            height: 2rem;
            border-radius: 0.5rem;
            border: 1px solid var(--border-light);
            background: var(--bg-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .theme-toggle:hover {
            background: var(--accent-light);
            border-color: var(--accent-primary);
        }

        .quick-actions {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .fab {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--accent-primary);
            color: white;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .fab:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(200, 169, 104, 0.4);
        }

        @media (max-width: 768px) {
            .main-content {
                margin-left: 0;
                padding: 1rem;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .management-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                bottom: 1rem;
                right: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- ÏÉÅÎã® Ìó§Îçî -->
    <header class="header">
        <div class="header-left">
            <button class="sidebar-toggle" onclick="toggleSidebar()">
                <span id="toggle-icon">‚óÄ</span>
            </button>
            <div class="header-logo">
                <span class="logo-icon">A</span>
                <span class="logo-text">AHP System</span>
                <span class="header-subtitle">ÏäàÌçº Í¥ÄÎ¶¨Ïûê</span>
            </div>
        </div>
        
        <div class="header-center">
            <nav class="header-nav">
                <a href="/ahp_app/super-admin-dashboard.html" class="nav-item active" data-page="admin">ÏäàÌçº Í¥ÄÎ¶¨Ïûê</a>
                <a href="/ahp_app/personal-service-enhanced.html" class="nav-item" data-page="personal">Í∞úÏù∏ ÏÑúÎπÑÏä§</a>
                <a href="/ahp_app/public/system-monitoring.html" class="nav-item" data-page="system">ÏãúÏä§ÌÖú Î™®ÎãàÌÑ∞ÎßÅ</a>
                <a href="/ahp_app/public/analytics.html" class="nav-item" data-page="analytics">Î∂ÑÏÑù</a>
            </nav>
        </div>
        
        <div class="header-right">
            <div class="theme-controls">
                <button class="theme-toggle" onclick="toggleColorTheme()" title="Ïª¨Îü¨ÌÖåÎßà Î≥ÄÍ≤Ω">üé®</button>
                <button class="theme-toggle" onclick="toggleDarkMode()" title="Îã§ÌÅ¨Î™®Îìú Ï†ÑÌôò">üåì</button>
            </div>
            <div class="header-notifications">
                <button class="notification-btn">
                    <span>üîî</span>
                    <span class="notification-badge">3</span>
                </button>
            </div>
            <div class="header-user">
                <div class="user-avatar">üë§</div>
                <div class="user-info">
                    <div class="user-name">ÏäàÌçº Í¥ÄÎ¶¨Ïûê</div>
                    <div class="user-role">System Admin</div>
                </div>
                <button class="user-menu-btn" onclick="handleLogout()">Î°úÍ∑∏ÏïÑÏõÉ</button>
            </div>
        </div>
    </header>

    <!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
    <nav id="sidebar" class="sidebar">
        <div class="sidebar-content">
            <!-- Í¥ÄÎ¶¨Ïûê Î©îÎâ¥ -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">ÏãúÏä§ÌÖú Í¥ÄÎ¶¨</div>
                <a href="/ahp_app/public/user-management.html" class="sidebar-item">
                    <span class="sidebar-icon">üë•</span>
                    <span class="sidebar-text">ÏÇ¨Ïö©Ïûê Í¥ÄÎ¶¨</span>
                </a>
                <a href="/ahp_app/public/project-overview.html" class="sidebar-item">
                    <span class="sidebar-icon">üìä</span>
                    <span class="sidebar-text">ÌîÑÎ°úÏ†ùÌä∏ ÌòÑÌô©</span>
                </a>
                <a href="/ahp_app/public/admin/system-settings.html" class="sidebar-item">
                    <span class="sidebar-icon">‚öôÔ∏è</span>
                    <span class="sidebar-text">ÏãúÏä§ÌÖú ÏÑ§Ï†ï</span>
                </a>
                <a href="/ahp_app/public/admin/audit-log.html" class="sidebar-item">
                    <span class="sidebar-icon">üìã</span>
                    <span class="sidebar-text">Í∞êÏÇ¨ Î°úÍ∑∏</span>
                </a>
            </div>

            <!-- Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨ -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨</div>
                <a href="/ahp_app/public/admin/backup-restore.html" class="sidebar-item">
                    <span class="sidebar-icon">üíæ</span>
                    <span class="sidebar-text">Î∞±ÏóÖ Î∞è Î≥µÏõê</span>
                </a>
                <a href="/ahp_app/public/admin/database-management.html" class="sidebar-item">
                    <span class="sidebar-icon">üóÑÔ∏è</span>
                    <span class="sidebar-text">Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Í¥ÄÎ¶¨</span>
                </a>
                <a href="/ahp_app/public/admin/data-migration.html" class="sidebar-item">
                    <span class="sidebar-icon">üì§</span>
                    <span class="sidebar-text">Îç∞Ïù¥ÌÑ∞ ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò</span>
                </a>
            </div>

            <!-- Î≥¥Ïïà Í¥ÄÎ¶¨ -->
            <div class="sidebar-section">
                <div class="sidebar-section-title">Î≥¥Ïïà Í¥ÄÎ¶¨</div>
                <a href="/ahp_app/public/admin/security-settings.html" class="sidebar-item">
                    <span class="sidebar-icon">üîí</span>
                    <span class="sidebar-text">Î≥¥Ïïà ÏÑ§Ï†ï</span>
                </a>
                <a href="/ahp_app/public/admin/access-control.html" class="sidebar-item">
                    <span class="sidebar-icon">üõ°Ô∏è</span>
                    <span class="sidebar-text">Ï†ëÍ∑º Ï†úÏñ¥</span>
                </a>
                <a href="/ahp_app/public/admin/security-log.html" class="sidebar-item">
                    <span class="sidebar-icon">üö®</span>
                    <span class="sidebar-text">Î≥¥Ïïà Î°úÍ∑∏</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† -->
    <main class="main-content">
        <!-- ÎåÄÏãúÎ≥¥Îìú ÌÜµÍ≥Ñ -->
        <div class="dashboard-grid">
            <div class="admin-card">
                <div class="admin-card-header">
                    <div class="admin-card-title">
                        <span class="admin-card-icon">üë•</span>
                        Ï¥ù ÏÇ¨Ïö©Ïûê
                    </div>
                </div>
                <div class="admin-card-value">1,247</div>
                <div class="admin-card-change change-positive">
                    ‚Üë +12% (Ïù¥Î≤à Îã¨)
                </div>
            </div>

            <div class="admin-card">
                <div class="admin-card-header">
                    <div class="admin-card-title">
                        <span class="admin-card-icon">üìä</span>
                        ÌôúÏÑ± ÌîÑÎ°úÏ†ùÌä∏
                    </div>
                </div>
                <div class="admin-card-value">89</div>
                <div class="admin-card-change change-positive">
                    ‚Üë +8% (Ïù¥Î≤à Ï£º)
                </div>
            </div>

            <div class="admin-card">
                <div class="admin-card-header">
                    <div class="admin-card-title">
                        <span class="admin-card-icon">‚ö°</span>
                        ÏãúÏä§ÌÖú ÏÑ±Îä•
                    </div>
                </div>
                <div class="admin-card-value">98.7%</div>
                <div class="admin-card-change change-positive">
                    ‚Üë ÏïàÏ†ïÏ†Å
                </div>
            </div>

            <div class="admin-card">
                <div class="admin-card-header">
                    <div class="admin-card-title">
                        <span class="admin-card-icon">üíæ</span>
                        Ï†ÄÏû•ÏÜå ÏÇ¨Ïö©Î•†
                    </div>
                </div>
                <div class="admin-card-value">67.3%</div>
                <div class="admin-card-change change-negative">
                    ‚Üë +5% (Ïù¥Î≤à Îã¨)
                </div>
            </div>
        </div>

        <!-- Í¥ÄÎ¶¨ ÏÑπÏÖò -->
        <div class="management-section">
            <div class="section-header">
                <h2 class="section-title">ÌïµÏã¨ Í¥ÄÎ¶¨ Í∏∞Îä•</h2>
            </div>
            <div class="management-grid">
                <div class="management-card" onclick="window.location.href='/ahp_app/public/user-management.html'">
                    <div class="management-card-icon">üë•</div>
                    <div class="management-card-title">ÏÇ¨Ïö©Ïûê Í¥ÄÎ¶¨</div>
                    <div class="management-card-desc">
                        ÏÇ¨Ïö©Ïûê Í≥ÑÏ†ï, Í∂åÌïú, ÌîÑÎ°úÌïÑ Í¥ÄÎ¶¨ Î∞è Ï†ëÍ∑º Ï†úÏñ¥
                    </div>
                </div>

                <div class="management-card" onclick="window.location.href='/ahp_app/public/project-overview.html'">
                    <div class="management-card-icon">üìä</div>
                    <div class="management-card-title">ÌîÑÎ°úÏ†ùÌä∏ Í¥ÄÎ¶¨</div>
                    <div class="management-card-desc">
                        Î™®Îì† AHP ÌîÑÎ°úÏ†ùÌä∏ ÌòÑÌô© Î™®ÎãàÌÑ∞ÎßÅ Î∞è Í¥ÄÎ¶¨
                    </div>
                </div>

                <div class="management-card" onclick="window.location.href='/ahp_app/public/system-monitoring.html'">
                    <div class="management-card-icon">üìà</div>
                    <div class="management-card-title">ÏãúÏä§ÌÖú Î™®ÎãàÌÑ∞ÎßÅ</div>
                    <div class="management-card-desc">
                        ÏÑúÎ≤Ñ ÏÑ±Îä•, Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§, API ÏÉÅÌÉú Ïã§ÏãúÍ∞Ñ Î™®ÎãàÌÑ∞ÎßÅ
                    </div>
                </div>

                <div class="management-card" onclick="window.location.href='/ahp_app/public/backup-restore.html'">
                    <div class="management-card-icon">üíæ</div>
                    <div class="management-card-title">Î∞±ÏóÖ Í¥ÄÎ¶¨</div>
                    <div class="management-card-desc">
                        Îç∞Ïù¥ÌÑ∞ Î∞±ÏóÖ, Î≥µÏõê Î∞è Ïû¨Ìï¥ Î≥µÍµ¨ Í¥ÄÎ¶¨
                    </div>
                </div>

                <div class="management-card" onclick="window.location.href='/ahp_app/public/security-settings.html'">
                    <div class="management-card-icon">üîí</div>
                    <div class="management-card-title">Î≥¥Ïïà ÏÑ§Ï†ï</div>
                    <div class="management-card-desc">
                        ÏãúÏä§ÌÖú Î≥¥Ïïà Ï†ïÏ±Ö, Ïù∏Ï¶ù Î∞è ÏïîÌò∏Ìôî ÏÑ§Ï†ï
                    </div>
                </div>

                <div class="management-card" onclick="window.location.href='/ahp_app/public/analytics.html'">
                    <div class="management-card-icon">üìã</div>
                    <div class="management-card-title">Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏</div>
                    <div class="management-card-desc">
                        ÏÇ¨Ïö©Ïûê ÌôúÎèô, ÏãúÏä§ÌÖú ÏÇ¨Ïö©Î•† Î∞è ÏÑ±Îä• Î∂ÑÏÑù
                    </div>
                </div>
            </div>
        </div>

        <!-- ÏµúÍ∑º ÌôúÎèô -->
        <div class="recent-activity">
            <div class="section-header">
                <h2 class="section-title">ÏµúÍ∑º ÏãúÏä§ÌÖú ÌôúÎèô</h2>
            </div>
            <ul class="activity-list">
                <li class="activity-item">
                    <div class="activity-icon user">üë§</div>
                    <div class="activity-content">
                        <div class="activity-title">ÏÉà ÏÇ¨Ïö©Ïûê Îì±Î°ù: ÍπÄÏ≤†Ïàò (kim.cs@company.com)</div>
                        <div class="activity-time">5Î∂Ñ Ï†Ñ</div>
                    </div>
                </li>
                <li class="activity-item">
                    <div class="activity-icon system">‚öôÔ∏è</div>
                    <div class="activity-content">
                        <div class="activity-title">ÏãúÏä§ÌÖú Î∞±ÏóÖ ÏôÑÎ£å (DB: 2.3GB, Files: 856MB)</div>
                        <div class="activity-time">1ÏãúÍ∞Ñ Ï†Ñ</div>
                    </div>
                </li>
                <li class="activity-item">
                    <div class="activity-icon project">üìä</div>
                    <div class="activity-content">
                        <div class="activity-title">ÎåÄÍ∑úÎ™® AHP ÌîÑÎ°úÏ†ùÌä∏ ÏÉùÏÑ±: "Ï†úÌíà ÏÑ†ÌÉù Î∂ÑÏÑù" (15Í∞ú Í∏∞Ï§Ä, 8Í∞ú ÎåÄÏïà)</div>
                        <div class="activity-time">2ÏãúÍ∞Ñ Ï†Ñ</div>
                    </div>
                </li>
                <li class="activity-item">
                    <div class="activity-icon alert">üö®</div>
                    <div class="activity-content">
                        <div class="activity-title">CPU ÏÇ¨Ïö©Î•† ÏûÑÍ≥ÑÏπò Ï¥àÍ≥º Í≤ΩÍ≥† (85% ‚Üí Ï†ïÏÉÅ Î≥µÍµ¨)</div>
                        <div class="activity-time">3ÏãúÍ∞Ñ Ï†Ñ</div>
                    </div>
                </li>
                <li class="activity-item">
                    <div class="activity-icon user">üë§</div>
                    <div class="activity-content">
                        <div class="activity-title">Í¥ÄÎ¶¨Ïûê Í∂åÌïú Î≥ÄÍ≤Ω: Ïù¥ÏòÅÌù¨ ‚Üí ÌîÑÎ°úÏ†ùÌä∏ Îß§ÎãàÏ†Ä</div>
                        <div class="activity-time">4ÏãúÍ∞Ñ Ï†Ñ</div>
                    </div>
                </li>
            </ul>
        </div>
    </main>

    <!-- Îπ†Î•∏ ÏûëÏóÖ Î≤ÑÌäº -->
    <div class="quick-actions">
        <button class="fab" title="ÏÉà ÏÇ¨Ïö©Ïûê Ï∂îÍ∞Ä" onclick="window.location.href='/ahp_app/public/user-management.html'">
            üë§
        </button>
        <button class="fab" title="ÏãúÏä§ÌÖú ÏÑ§Ï†ï" onclick="window.location.href='/ahp_app/public/system-settings.html'">
            ‚öôÔ∏è
        </button>
    </div>

    <script src="/ahp_app/public/scripts/layout.js"></script>
    <script src="/ahp_app/public/scripts/api-service.js"></script>
    <script>
        // ÌéòÏù¥ÏßÄ Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', async function() {
            // Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú ÌôïÏù∏
            const loginResult = await checkLoginStatus();
            if (!loginResult) {
                return;
            }
            
            // Í¥ÄÎ¶¨Ïûê Í∂åÌïú ÌôïÏù∏
            const adminResult = await checkAdminPermission();
            if (!adminResult) {
                alert('Í¥ÄÎ¶¨Ïûê Í∂åÌïúÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
                window.location.href = '/ahp_app/public/personal-service-enhanced.html';
                return;
            }
            
            // ÌÖåÎßà Ï†ÅÏö©
            loadSavedTheme();
            
            // Îã§ÌÅ¨Î™®Îìú ÏÑ§Ï†ï Î≥µÏõê
            try {
                const result = await window.ahpApi.getUserSettings();
                if (result.success && result.data.theme) {
                    document.documentElement.setAttribute('data-theme', result.data.theme);
                }
            } catch (error) {
                console.log('ÏÑ§Ï†ï Î°úÎìú Ïã§Ìå®, Í∏∞Î≥∏ ÏÑ§Ï†ï ÏÇ¨Ïö©');
            }
            
            initializePage({
                menuId: 'admin-dashboard',
                pageId: 'admin',
                title: 'ÏäàÌçº Í¥ÄÎ¶¨Ïûê ÎåÄÏãúÎ≥¥Îìú'
            });
            
            // Django API Ïó∞Îèô Ï¥àÍ∏∞Ìôî
            initializeDjangoAPI();
            
            console.log('‚úÖ ÏäàÌçº Í¥ÄÎ¶¨Ïûê ÎåÄÏãúÎ≥¥Îìú Î°úÎìú ÏôÑÎ£å');
        });

        // Í¥ÄÎ¶¨Ïûê Í∂åÌïú ÌôïÏù∏
        async function checkAdminPermission() {
            try {
                const result = await window.ahpApi.getCurrentUser();
                return result.success && result.user.role === 'admin';
            } catch (error) {
                console.error('ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ Ï°∞Ìöå Ïò§Î•ò:', error);
                return false;
            }
        }

        // Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú ÌôïÏù∏
        async function checkLoginStatus() {
            try {
                const result = await window.ahpApi.getCurrentUser();
                if (!result.success) {
                    window.location.href = '/ahp_app/public/login.html';
                    return false;
                }
                
                const user = result.user;
                const userNameElement = document.querySelector('.header-user .user-name');
                if (userNameElement && user.name) {
                    userNameElement.textContent = user.name;
                }
                
                return true;
            } catch (error) {
                console.error('ÏÇ¨Ïö©Ïûê Ïù∏Ï¶ù ÌôïÏù∏ Ïò§Î•ò:', error);
                window.location.href = '/ahp_app/public/login.html';
                return false;
            }
        }

        // ÏÇ¨Ïù¥ÎìúÎ∞î ÌÜ†Í∏Ä
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const toggleIcon = document.getElementById('toggle-icon');
            
            sidebar.classList.toggle('collapsed');
            toggleIcon.textContent = sidebar.classList.contains('collapsed') ? '‚ñ∂' : '‚óÄ';
        }

        // Ïª¨Îü¨ ÌÖåÎßà Î≥ÄÍ≤Ω
        function toggleColorTheme() {
            const themes = [
                { name: 'default', primary: '#C8A968', secondary: '#A98C4B', light: '#E5D5AA', hover: '#B59A4D' },
                { name: 'blue', primary: '#3B82F6', secondary: '#2563EB', light: '#DBEAFE', hover: '#1D4ED8' },
                { name: 'green', primary: '#10B981', secondary: '#059669', light: '#D1FAE5', hover: '#047857' },
                { name: 'purple', primary: '#8B5CF6', secondary: '#7C3AED', light: '#EDE9FE', hover: '#6D28D9' },
                { name: 'rose', primary: '#F43F5E', secondary: '#E11D48', light: '#FFE4E6', hover: '#BE123C' }
            ];
            
            const currentTheme = localStorage.getItem('colorTheme') || 'default';
            const currentIndex = themes.findIndex(t => t.name === currentTheme);
            const nextIndex = (currentIndex + 1) % themes.length;
            const nextTheme = themes[nextIndex];
            
            // CSS Î≥ÄÏàò ÏóÖÎç∞Ïù¥Ìä∏
            const root = document.documentElement;
            root.style.setProperty('--accent-primary', nextTheme.primary);
            root.style.setProperty('--accent-secondary', nextTheme.secondary);
            root.style.setProperty('--accent-light', nextTheme.light);
            root.style.setProperty('--accent-hover', nextTheme.hover);
            
            // ÌÖåÎßà Ï†ÄÏû•
            localStorage.setItem('colorTheme', nextTheme.name);
            
            console.log(`Ïª¨Îü¨ ÌÖåÎßà Î≥ÄÍ≤Ω: ${nextTheme.name}`);
        }

        // Ï†ÄÏû•Îêú ÌÖåÎßà Ï†ÅÏö©
        function loadSavedTheme() {
            const themes = [
                { name: 'default', primary: '#C8A968', secondary: '#A98C4B', light: '#E5D5AA', hover: '#B59A4D' },
                { name: 'blue', primary: '#3B82F6', secondary: '#2563EB', light: '#DBEAFE', hover: '#1D4ED8' },
                { name: 'green', primary: '#10B981', secondary: '#059669', light: '#D1FAE5', hover: '#047857' },
                { name: 'purple', primary: '#8B5CF6', secondary: '#7C3AED', light: '#EDE9FE', hover: '#6D28D9' },
                { name: 'rose', primary: '#F43F5E', secondary: '#E11D48', light: '#FFE4E6', hover: '#BE123C' }
            ];
            
            const savedTheme = localStorage.getItem('colorTheme') || 'default';
            const theme = themes.find(t => t.name === savedTheme);
            
            if (theme) {
                const root = document.documentElement;
                root.style.setProperty('--accent-primary', theme.primary);
                root.style.setProperty('--accent-secondary', theme.secondary);
                root.style.setProperty('--accent-light', theme.light);
                root.style.setProperty('--accent-hover', theme.hover);
            }
        }

        // Îã§ÌÅ¨Î™®Îìú ÌÜ†Í∏Ä
        async function toggleDarkMode() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            
            // ÏÑúÎ≤ÑÏóê ÏÇ¨Ïö©Ïûê ÏÑ§Ï†ï Ï†ÄÏû•
            try {
                const settings = { theme: newTheme };
                await window.ahpApi.saveUserSettings(settings);
                console.log(`Îã§ÌÅ¨Î™®Îìú Î≥ÄÍ≤Ω: ${newTheme}`);
            } catch (error) {
                console.error('ÌÖåÎßà ÏÑ§Ï†ï Ï†ÄÏû• Ïò§Î•ò:', error);
            }
        }

        // API Í∏∞Î≥∏ ÏÑ§Ï†ï
        const API_BASE_URL = 'https://ahp-django-backend.onrender.com';
        
        // Django API Ï¥àÍ∏∞Ìôî
        async function initializeDjangoAPI() {
            const loginMethod = localStorage.getItem('login_method');
            
            if (loginMethod === 'django') {
                try {
                    // Î∞±ÏóîÎìú ÏÉÅÌÉú ÌôïÏù∏
                    const healthResponse = await fetch(`${API_BASE_URL}/api/health/`);
                    if (healthResponse.ok) {
                        const healthData = await healthResponse.json();
                        console.log('‚úÖ Django Î∞±ÏóîÎìú Ï†ïÏÉÅ Ïó∞Í≤∞');
                        console.log('üìä PostgreSQL Ïó∞Í≤∞ ÏÉÅÌÉú:', healthData.database?.status);
                        
                        // Í¥ÄÎ¶¨Ïûê ÌÜµÍ≥Ñ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                        await loadAdminStatistics();
                        
                        // ÏãúÏä§ÌÖú ÌôúÎèô Î°úÍ∑∏ Î°úÎìú
                        await loadSystemActivities();
                        
                    }
                } catch (error) {
                    console.error('‚ùå Django API Ï¥àÍ∏∞Ìôî Ïã§Ìå®:', error);
                }
            } else {
                console.log('üìù Îç∞Î™® Î™®ÎìúÎ°ú Ïã§Ìñâ Ï§ë');
            }
        }
        
        // Í¥ÄÎ¶¨Ïûê ÌÜµÍ≥Ñ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        async function loadAdminStatistics() {
            try {
                const token = localStorage.getItem('ahp_token');
                const headers = {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                };
                
                // Ï†ÑÏ≤¥ ÏÇ¨Ïö©Ïûê Ïàò Ï°∞Ìöå (ÏòàÏãú)
                const usersResponse = await fetch(`${API_BASE_URL}/api/admin/users/count/`, {
                    headers
                });
                
                // Ï†ÑÏ≤¥ ÌîÑÎ°úÏ†ùÌä∏ Ïàò Ï°∞Ìöå
                const projectsResponse = await fetch(`${API_BASE_URL}/api/service/projects/`, {
                    headers
                });
                
                if (usersResponse.ok && projectsResponse.ok) {
                    const userData = await usersResponse.json();
                    const projectData = await projectsResponse.json();
                    
                    // UI ÏóÖÎç∞Ïù¥Ìä∏
                    updateAdminStatistics({
                        totalUsers: userData.count || 0,
                        activeProjects: projectData.length || 0
                    });
                    
                    console.log('üìä Django Í¥ÄÎ¶¨Ïûê ÌÜµÍ≥Ñ Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏôÑÎ£å');
                }
            } catch (error) {
                console.log('‚ö†Ô∏è Í¥ÄÎ¶¨Ïûê ÌÜµÍ≥Ñ Î°úÎìú Ïã§Ìå®, Í∏∞Î≥∏Í∞í ÏÇ¨Ïö©:', error);
            }
        }
        
        // ÏãúÏä§ÌÖú ÌôúÎèô Î°úÍ∑∏ Î°úÎìú
        async function loadSystemActivities() {
            try {
                const token = localStorage.getItem('ahp_token');
                const response = await fetch(`${API_BASE_URL}/api/admin/activities/`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const activities = await response.json();
                    updateActivityLog(activities);
                    console.log('üìã ÏãúÏä§ÌÖú ÌôúÎèô Î°úÍ∑∏ Î°úÎìú ÏôÑÎ£å');
                }
            } catch (error) {
                console.log('‚ö†Ô∏è ÌôúÎèô Î°úÍ∑∏ Î°úÎìú Ïã§Ìå®, Í∏∞Î≥∏Í∞í ÏÇ¨Ïö©:', error);
            }
        }
        
        // Í¥ÄÎ¶¨Ïûê ÌÜµÍ≥Ñ UI ÏóÖÎç∞Ïù¥Ìä∏
        function updateAdminStatistics(stats) {
            const userCountElement = document.querySelector('.admin-card:first-child .admin-card-value');
            const projectCountElement = document.querySelector('.admin-card:nth-child(2) .admin-card-value');
            
            if (userCountElement && stats.totalUsers > 0) {
                userCountElement.textContent = stats.totalUsers.toLocaleString();
            }
            
            if (projectCountElement && stats.activeProjects > 0) {
                projectCountElement.textContent = stats.activeProjects.toString();
            }
        }
        
        // ÌôúÎèô Î°úÍ∑∏ UI ÏóÖÎç∞Ïù¥Ìä∏
        function updateActivityLog(activities) {
            const activityList = document.querySelector('.activity-list');
            if (!activityList || !activities || activities.length === 0) return;
            
            // Ïã§Ï†ú Django Îç∞Ïù¥ÌÑ∞Î°ú ÌôúÎèô Î°úÍ∑∏ ÏóÖÎç∞Ïù¥Ìä∏
            activityList.innerHTML = '';
            
            activities.slice(0, 5).forEach(activity => {
                const activityItem = document.createElement('li');
                activityItem.className = 'activity-item';
                activityItem.innerHTML = `
                    <div class="activity-icon ${activity.type || 'system'}">
                        ${getActivityIcon(activity.type)}
                    </div>
                    <div class="activity-content">
                        <div class="activity-title">${activity.description || activity.message}</div>
                        <div class="activity-time">${formatActivityTime(activity.timestamp || activity.created_at)}</div>
                    </div>
                `;
                activityList.appendChild(activityItem);
            });
        }
        
        // ÌôúÎèô ÌÉÄÏûÖÎ≥Ñ ÏïÑÏù¥ÏΩò
        function getActivityIcon(type) {
            const icons = {
                'user': 'üë§',
                'project': 'üìä', 
                'system': '‚öôÔ∏è',
                'alert': 'üö®'
            };
            return icons[type] || 'üìã';
        }
        
        // ÏãúÍ∞Ñ Ìè¨Îß∑ÌåÖ
        function formatActivityTime(timestamp) {
            if (!timestamp) return 'Î∞©Í∏à Ï†Ñ';
            
            const now = new Date();
            const activityTime = new Date(timestamp);
            const diffMs = now - activityTime;
            const diffMins = Math.floor(diffMs / (1000 * 60));
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            
            if (diffMins < 60) {
                return `${diffMins}Î∂Ñ Ï†Ñ`;
            } else if (diffHours < 24) {
                return `${diffHours}ÏãúÍ∞Ñ Ï†Ñ`;
            } else {
                return activityTime.toLocaleDateString('ko-KR');
            }
        }

        // Î°úÍ∑∏ÏïÑÏõÉ
        async function handleLogout() {
            if (confirm('Î°úÍ∑∏ÏïÑÏõÉ ÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                try {
                    await window.ahpApi.logout();
                    window.location.href = '/ahp_app/public/login.html?message=logout';
                } catch (error) {
                    console.error('Î°úÍ∑∏ÏïÑÏõÉ Ïò§Î•ò:', error);
                    window.location.href = '/ahp_app/public/login.html?message=logout';
                }
            }
        }
    </script>
</body>
</html>